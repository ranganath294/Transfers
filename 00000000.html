def gen_cr_freq_info(cr_df, tc_df):
    # print(tc_df.columns)
    
    # Filter tc_df to include only rows where the "Result" column is "Failed"
    tc_df = tc_df[tc_df["Result"] == "Failed"]
    
    tc_df = tc_df.dropna(subset=["Issues"])
    tc_df["Issues"] = tc_df["Issues"].str.strip()
    tc_df = tc_df[tc_df["Issues"] != ""]
    tc_df = tc_df[tc_df["Issues"].notna() & (tc_df["Issues"] != "")]
    print("1", tc_df["Issues"])
    tc_df = tc_df.copy()
    # tc_df["CR"] = tc_df["Issues"].apply(
    #     lambda x: [i for i in str(x).split(",") if i.startswith("CR-")]
    # )
    tc_df.to_csv(r"C:\Dropbox\To Laptop\New folder\debug\tc_df_1.csv")
    
    # Ensure the "Issues" column is treated as a string
    # tc_df["Issues"] = tc_df["Issues"].astype(str)
    
    def remove_duplicates_from_issues(issues_str):
        if pd.isna(issues_str):
            return ""
        issues_list = issues_str.split(',')
        unique_issues = list(set(issues_list))
        unique_issues.sort()
        return ','.join(unique_issues)
    
    # Create a temporary column to handle duplicates within each row
    # tc_df["Temp_Issues"] = tc_df["Issues"].apply(lambda x: ','.join(set(str(x).split(','))))
    tc_df["Temp_Issues"] = tc_df["Issues"].apply(remove_duplicates_from_issues)
    
    tc_df["CR"] = tc_df["Temp_Issues"].str.split(",")
    tc_df = tc_df.explode("CR")
    tc_df = tc_df[tc_df['CR'].str.contains('CR-')]
    print("2", tc_df["CR"])
    print(len(tc_df["CR"]))
    tc_df.to_csv(r"C:\Dropbox\To Laptop\New folder\debug\tc_df_2.csv")
    
    # Remove duplicate rows - Added to remove the duplicates present in same row of issues column. Simple to remove after exploding. If more num of duplicates are expected then better to use a lambda and remove duplicates before exploding for efficiency. 
    # tc_df = tc_df.drop_duplicates()
    tc_df.to_csv(r"C:\Dropbox\To Laptop\New folder\debug\tc_df_3.csv")
