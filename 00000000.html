def download_excel(request):
    # Path to the Excel file
    selected_sp = request.GET.get('sp_name', '')
    file_path = os.path.join(ConfigPaths.download_excel_files, "coverage_reports", f"{selected_sp}_coverage_report.xlsx")
    print(file_path)
    
    # Check if the file exists
    if not os.path.exists(file_path):
        error_msg = "File not found"
        return JsonResponse({'status': 'error', 'error_msg': error_msg})
    
    # Open the Excel file
    try:
        with open(file_path, 'rb') as file:
            response = HttpResponse(file.read(), content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
            response['Content-Disposition'] = f'attachment; filename="example.xlsx"'
            return response
    except Exception as e:
        return JsonResponse({'status': 'error', 'error_msg': str(e)}, status=500)

this is a djnahgo view to download an excel file. 
and html froentend is 
<script>
    document.getElementById('downloadButton').addEventListener('click', function() {
        const spSelect = document.getElementById('sp_name');
        const selectedSp = spSelect.value;
        if (!selectedSp) {
            addAlert('danger', 'Please select an SP first')
            // alert('Please select an SP first');
            return;
        }
        const params = new URLSearchParams();
        params.append('sp_name', selectedSp);

        fetch(`{% url 'cst_reporting_views:download_excel' %}?${params.toString()}`)
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.error_msg);
                    });
                }
                return response.blob();
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'example.xlsx';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
                addAlert('success', 'File downloaded successfully!');
            })
            .catch(error => {
                addAlert('success', `Error: ${error.message}`);
                document.getElementById('statusMessage').textContent = 'Error: ' + error.message;
            });
    });
</script>

but after downloading i am unable to open excel file. it is saying 
Excel cannot open the file 'example.xlsx' because the file format or file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file.
