function renderCumulativeTable(tableData, data, targetElementId) {
    console.log("renderCumulativeTable");
    const targetElement = document.getElementById(targetElementId);
    targetElement.innerHTML = ''; // Clear everything first

    // Create button container
    const buttonContainer = document.createElement('div');
    buttonContainer.id = 'cumulativeTableFilters';
    buttonContainer.className = 'mb-3';

    // Create button group
    const buttonGroup = document.createElement('div');
    buttonGroup.className = 'btn-group';
    buttonGroup.setAttribute('role', 'group');
    buttonGroup.setAttribute('aria-label', 'Report filters');

    // Create Complete Report button
    const completeReportInput = document.createElement('input');
    completeReportInput.type = 'radio';
    completeReportInput.className = 'btn-check team-filter';
    completeReportInput.name = 'report-filter';
    completeReportInput.id = 'complete-report';
    completeReportInput.value = 'complete-report';
    completeReportInput.checked = true;

    const completeReportLabel = document.createElement('label');
    completeReportLabel.className = 'btn btn-outline-primary';
    completeReportLabel.setAttribute('for', 'complete-report');
    completeReportLabel.textContent = 'Complete Report';

    // Create CR Verification button
    const crVerificationInput = document.createElement('input');
    crVerificationInput.type = 'radio';
    crVerificationInput.className = 'btn-check team-filter';
    crVerificationInput.name = 'report-filter';
    crVerificationInput.id = 'cr-verification';
    crVerificationInput.value = 'cr-verification';

    const crVerificationLabel = document.createElement('label');
    crVerificationLabel.className = 'btn btn-outline-primary';
    crVerificationLabel.setAttribute('for', 'cr-verification');
    crVerificationLabel.textContent = 'CR Verification';

    // Append buttons to button group
    buttonGroup.appendChild(completeReportInput);
    buttonGroup.appendChild(completeReportLabel);
    buttonGroup.appendChild(crVerificationInput);
    buttonGroup.appendChild(crVerificationLabel);

    // Append button group to button container
    buttonContainer.appendChild(buttonGroup);

    // Create content container for tables
    const contentContainer = document.createElement('div');
    contentContainer.id = 'reportContentContainer';

    // Append both containers to target element
    targetElement.appendChild(buttonContainer);
    targetElement.appendChild(contentContainer);

    // Add event listeners for report filter buttons
    completeReportInput.addEventListener('change', () => {
        if (completeReportInput.checked) {
            console.log('Complete Report clicked');
            contentContainer.innerHTML = ''; // Clear the content container
            renderCompleteReportInCumulativeTable(tableData, data, contentContainer);
        }
    });

    crVerificationInput.addEventListener('change', async () => {
        if (crVerificationInput.checked) {
            console.log('CR Verification clicked');
            const spSelect = document.getElementById('sp_name');
            const selectedSp = spSelect.value;
            if (!selectedSp) {
                alert('Please select an SP first');
                return;
            }

            contentContainer.innerHTML = ''; // Clear the content container

            let columnNames;
            if (!crVerificationData) {
                const params = new URLSearchParams();
                params.append('sp_name', selectedSp);
                try {
                    const response = await fetch(`{% url 'cst_reporting_views:get_cr_verification_data' %}?${params.toString()}`);
                    if (!response.ok) throw new Error('Network response was not ok');
                    const responseData = await response.json();
                    crVerificationData = responseData["data"];
                    columnNames = responseData["column_names"];
                } catch (error) {
                    console.error('Error fetching data:', error);
                    alert('Error fetching data. Please try again.');
                    return;
                }
            } else {
                columnNames = Object.keys(crVerificationData[Object.keys(crVerificationData)[0]][Object.keys(crVerificationData[Object.keys(crVerificationData)[0]])[0]][0]);
            }

            const cardElement = document.createElement('div');
            cardElement.className = 'card';
            const cardBody = document.createElement('div');
            cardBody.className = 'card-body';
            cardElement.appendChild(cardBody);
            contentContainer.appendChild(cardElement);

            renderCRVerificationInCumulativeTable(crVerificationData, columnNames, cardBody);
        }
    });

    // Add event listeners for "more" links
    targetElement.addEventListener('click', (e) => {
        if (e.target.classList.contains('show-more-list')) {
            e.preventDefault();
            const title = e.target.getAttribute('data-title');
            const list = JSON.parse(decodeURIComponent(e.target.getAttribute('data-list')));
            createListModal(title, list);
        }
    });

    // Initial render of Complete Report
    renderCompleteReportInCumulativeTable(tableData, data, contentContainer);
}

function renderCompleteReportInCumulativeTable(tableData, data, targetElement) {
    targetElement.innerHTML = ''; // Clear existing content

    // Create table element
    const table = document.createElement('table');
    table.className = 'coverage-table';
    
    // Rest of the table creation code remains the same...
    
    targetElement.appendChild(table);
    adjustColumnWidths();
}

function renderCRVerificationInCumulativeTable(tableData, columnNames, targetElement) {
    // Create table element
    const table = document.createElement('table');
    table.className = 'coverage-table';
    
    // Rest of the table creation code remains the same...
    
    targetElement.appendChild(table);
    adjustColumnWidths();
}