def add_coverage_report_slides(prs, coverage_summary_data, selected_sp, selected_teams=None, selected_phases=None):
    for sp in coverage_summary_data:
        sp_name = sp['sp_name']
        teams = sp['teams']

        # Filter teams and phases based on selection
        filtered_teams = []
        for team in teams:
            if selected_teams is None or team['team_name'] in selected_teams:
                filtered_phases = []
                for phase in team['phases']:
                    if selected_phases is None or phase['phase'] in selected_phases:
                        filtered_phases.append(phase)
                if filtered_phases:
                    filtered_teams.append({'team_name': team['team_name'], 'phases': filtered_phases})

        # Prepare data for each team and phase combination
        for team in filtered_teams:
            team_name = team['team_name']
            for phase in team['phases']:
                phase_name = phase['phase']
                phase_date = phase['date']
                coverage_types = phase['coverage_types']
                unique_issue_count = phase['unique_issue_count']
                phase_data, phase_merge_info = prepare_table_data([{'team_name': team_name, 'phases': [phase]}])
                if phase_data:
                    title_text = f"{sp_name} {team_name} {phase_name}"
                    slide = add_slide_with_table(prs, title_text, phase_data, phase_merge_info, Inches(0.0), Inches(2), Inches(11.6), Inches(0.4 * len(phase_data)))

                    # Add test group percentages table (left bottom)
                    test_group_percentages = calculate_test_group_percentages_data(sp_name, team_name, phase_name, coverage_summary_data)
                    if test_group_percentages:
                        test_group_table_data = [['Test Group', 'Test Group Percentage']] + [
                            [tg['test_group'], format_percentage(tg['test_group_percentage'])] for tg in test_group_percentages
                        ]
                        add_general_table_to_slide(slide, test_group_table_data, Inches(0.5), Inches(2 + 0.4 * len(phase_data) + 0.5), Inches(5.3), Inches(2.5))

                    # Add subsystem percentages table (right bottom)
                    subsystem_percentages = calculate_subsystem_percentages_data(sp_name, team_name, phase_name, coverage_summary_data)
                    if subsystem_percentages:
                        subsystem_table_data = [['Subsystem', 'Subsystem Percentage']] + [
                            [tg['subsystem'], format_percentage(tg['subsystemPercentage'])] for tg in subsystem_percentages
                        ]
                        add_general_table_to_slide(slide, subsystem_table_data, Inches(6.2), Inches(2 + 0.4 * len(phase_data) + 0.5), Inches(5.3), Inches(2.5))
