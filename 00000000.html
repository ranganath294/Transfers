function downloadReport(reportType) {
    const spSelect = document.getElementById('sp_name');
    const selectedSp = spSelect.value;
    if (!selectedSp) {
        addAlert('danger', 'Please select an SP first');
        return;
    }
    const params = new URLSearchParams();
    params.append('sp_name', selectedSp);
    params.append('reportType', reportType);
    fetch(`{% url 'cst_reporting_views:download_excel' %}?${params.toString()}`)
        .then(response => {
            if (!response.ok) {
                return response.json().then(data => {
                    throw new Error(data.error_msg);
                });
            }
            // Extract filename from Content-Disposition header
            const contentDisposition = response.headers.get('Content-Disposition');
            let filename = '';
            if (contentDisposition && contentDisposition.includes('filename=')) {
                filename = contentDisposition.split('filename=')[1].replace(/['"]/g, '');
            } else {
                filename = `${selectedSp}_${reportType}.xlsx`; // Fallback if filename is not found
            }
            return response.blob().then(blob => ({ blob, filename }));
        })
        .then(({ blob, filename }) => {
            console.log("Blob type:", blob.type);
            console.log("Blob size:", blob.size);
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            addAlert('success', `${filename} downloaded successfully!`);
        })
        .catch(error => {
            addAlert('danger', `Error: ${error.message}`);
            if (document.getElementById('statusMessage')) {
                document.getElementById('statusMessage').textContent = 'Error: ' + error.message;
            }
        });
}



even if there is no file and backend is sending if not os.path.exists(file_path):
        error_msg = "File not found"
        print(f"{file_path} not Found")
        return JsonResponse({'status': 'error', 'error_msg': error_msg})

not found frontend is showing something like there is a xlsx file downloaded and file downloaded successfully and when opened it shows invalid excel file

this is backend code. i want frontenbd code to be aligned with theis backend code, make both align
def download_excel(request):
    selected_sp = request.GET.get('sp_name', "")
    report_type = request.GET.get('reportType', "")
    error_msg = ""
    filename = ""
    content_type = ""

    if selected_sp == "":
        error_msg = "Please select an SP"
        return JsonResponse({'status': 'error', 'error_msg': error_msg})

    if report_type == "coverage_report":
        file_path = os.path.join(ConfigPaths.coverage_report_xls_dir, f"{selected_sp}_coverage_report.xlsx")
        filename = f"{selected_sp}_coverage_report.xlsx"
        content_type = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    elif report_type == "cr_verification_data":
        file_path = os.path.join(ConfigPaths.cr_verification_data_xls_dir, f"{selected_sp}_cr_verification_data.csv")
        filename = f"{selected_sp}_cr_verification_data.csv"
        content_type = 'text/csv'
    elif report_type == "scrum_sheet":
        file_path = os.path.join(ConfigPaths.scrum_sheet_xls_dir, f"{selected_sp}_scrum_sheet.xlsx")
        filename = f"{selected_sp}_scrum_sheet.csv"
        content_type = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    else:
        error_msg = "Invalid report type"
        return JsonResponse({'status': 'error', 'error_msg': error_msg})

    print(file_path)

    # Check if the file exists
    if not os.path.exists(file_path):
        error_msg = "File not found"
        print(f"{file_path} not Found")
        return JsonResponse({'status': 'error', 'error_msg': error_msg})

    # Open the file
    try:
        with open(file_path, 'rb') as file:
            response = HttpResponse(file.read(), content_type=content_type)
            response['Content-Disposition'] = f'attachment; filename="{filename}"'
            return response
    except Exception as e:
        return JsonResponse({'status': 'error', 'error_msg': str(e)}, status=500)
