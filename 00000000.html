function renderSPReportInCumulativeTable(coverageSummaryData, contentContainer) {
    // Create a single card structure for SP Report view
    const spReportCardElement = document.createElement('div');
    spReportCardElement.className = 'card mb-3';

    // Create card body
    const spReportCardBody = document.createElement('div');
    spReportCardBody.className = 'card-body';
    
    // Create phase filter container for SP Report view
    const phaseFilterContainer = document.createElement('div');
    phaseFilterContainer.className = 'mb-3'; // Add margin bottom for spacing

    // Create responsive flex container for downloads and phase buttons
    const headerContainer = document.createElement('div');
    headerContainer.className = 'd-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2';

    // Create downloads dropdown container (left side)
    const downloadsContainer = document.createElement('div');
    downloadsContainer.className = 'dropdown downloads-dropdown order-2 order-md-1';

    // Create downloads dropdown button
    const downloadButton = document.createElement('button');
    downloadButton.className = 'btn btn-primary dropdown-toggle';
    downloadButton.type = 'button';
    downloadButton.id = 'downloadDropdown';
    downloadButton.setAttribute('data-bs-toggle', 'dropdown');
    downloadButton.setAttribute('aria-expanded', 'false');
    downloadButton.textContent = 'Downloads';

    // Create downloads dropdown menu
    const downloadMenu = document.createElement('ul');
    downloadMenu.className = 'dropdown-menu';
    downloadMenu.setAttribute('aria-labelledby', 'downloadDropdown');

    // Create dropdown items
    const downloadItems = [
        { id: 'exportCoverageReport', text: 'Daily Coverage Report XL' },
        { id: 'exportScrumSheet', text: 'Export Scrum Sheet to XL' },
        { id: 'downloadSPReport', text: 'Download SP Report' }
    ];

    downloadItems.forEach(item => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.className = 'dropdown-item';
        a.href = '#';
        a.id = item.id;
        a.textContent = item.text;
        li.appendChild(a);
        downloadMenu.appendChild(li);
    });

    // Append dropdown elements
    downloadsContainer.appendChild(downloadButton);
    downloadsContainer.appendChild(downloadMenu);

    // Create phase button container (right side)
    const phaseButtonContainer = document.createElement('div');
    phaseButtonContainer.className = 'order-1 order-md-2';
    
    // Create button group for phase filters with 4px gap
    const spReportPhaseButtonGroup = document.createElement('div');
    spReportPhaseButtonGroup.className = 'btn-group';
    spReportPhaseButtonGroup.setAttribute('role', 'group');
    spReportPhaseButtonGroup.setAttribute('aria-label', 'Phase filters');
    spReportPhaseButtonGroup.style.gap = '4px'; // Add 4px gap between buttons
    
    // Create phase filter buttons
    const phases = ['ES', 'FC', 'CS'];
    phases.forEach(phase => {
        const button = document.createElement('button');
        button.type = 'button';
        button.className = `btn btn-outline-primary sp-report-phase-filter ${phase === 'ES' ? 'active' : ''}`;
        button.setAttribute('data-phase', phase);
        button.textContent = phase;
        spReportPhaseButtonGroup.appendChild(button);
    });
    
    // Append phase buttons to container
    phaseButtonContainer.appendChild(spReportPhaseButtonGroup);

    // Append both containers to header container
    headerContainer.appendChild(downloadsContainer);
    headerContainer.appendChild(phaseButtonContainer);
    
    // Create SP Report content container
    const spReportContentContainer = document.createElement('div');
    spReportContentContainer.id = 'spReportContentContainer';
    spReportContentContainer.className = 'mt-3'; // Add margin top for spacing
    
    // Append elements to the card
    phaseFilterContainer.appendChild(headerContainer);
    spReportCardBody.appendChild(phaseFilterContainer);
    spReportCardBody.appendChild(spReportContentContainer);
    spReportCardElement.appendChild(spReportCardBody);
    
    // Append card to the main content container
    contentContainer.appendChild(spReportCardElement);
    
    // Add event listeners for phase filter buttons
    spReportPhaseButtonGroup.addEventListener('click', async (e) => {
        if (e.target.classList.contains('sp-report-phase-filter')) {
            // Remove active class from all buttons
            spReportPhaseButtonGroup.querySelectorAll('.sp-report-phase-filter').forEach(btn => btn.classList.remove('active'));
            // Add active class to the clicked button
            e.target.classList.add('active');
            // Get the selected phase
            const selectedPhase = e.target.getAttribute('data-phase');
            
            // Clear the SP Report content container
            spReportContentContainer.innerHTML = '';
            
            // Render the table and graph with the selected phase
            await renderSPReportTableAndGraph(selectedPhase, spReportContentContainer);
        }
    });

    // Add event listeners for download buttons
    downloadMenu.addEventListener('click', (e) => {
        e.preventDefault();
        if (e.target.classList.contains('dropdown-item')) {
            const downloadId = e.target.id;
            // Handle download actions based on the clicked item ID
            switch (downloadId) {
                case 'exportCoverageReport':
                    // Handle Daily Coverage Report XL export
                    console.log('Exporting Daily Coverage Report XL');
                    break;
                case 'exportScrumSheet':
                    // Handle Scrum Sheet export
                    console.log('Exporting Scrum Sheet to XL');
                    break;
                case 'downloadSPReport':
                    // Handle SP Report download
                    console.log('Downloading SP Report');
                    break;
            }
        }
    });

    // Initial render of SP Report with default 'ES' phase
    renderSPReportTableAndGraph('ES', spReportContentContainer);
}