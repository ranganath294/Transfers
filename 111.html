detectInputType(defaultValue) {
    if (defaultValue === null) return this.inputTypes.STRING;

    if (Array.isArray(defaultValue)) {
        // If array is empty, return base array type
        if (defaultValue.length === 0) return this.inputTypes.ARRAY;
        
        const firstItem = defaultValue[0];
        const itemType = this.detectItemType(firstItem);
        
        // Preserve array context by prefixing with ARRAY
        return itemType === 'primitive' 
            ? `${this.inputTypes.ARRAY}_of_${this.detectInputType(firstItem)}` 
            : `${this.inputTypes.ARRAY}_of_${itemType}`;
    }
    
    if (typeof defaultValue === 'object') {
        // Check if it's a plain object with nested structures
        const objectEntries = Object.entries(defaultValue);
        if (objectEntries.length === 0) return this.inputTypes.OBJECT;
        
        // Check if any value is complex
        const hasComplexValue = objectEntries.some(([_, val]) => 
            Array.isArray(val) || (typeof val === 'object' && val !== null)
        );
        
        return hasComplexValue ? `${this.inputTypes.OBJECT}_with_complex_values` : this.inputTypes.OBJECT;
    }
    
    if (typeof defaultValue === 'boolean') return this.inputTypes.BOOLEAN;
    if (typeof defaultValue === 'number') return this.inputTypes.NUMBER;
    
    return this.inputTypes.STRING;
}















createInputBasedOnType(type, defaultValue, depth = 0) {
    const MAX_DEPTH = 3;
    if (depth > MAX_DEPTH) {
        console.warn('Maximum nesting depth reached');
        return this.createStringInput(JSON.stringify(defaultValue), () => {});
    }

    const onChangeCallback = (value) => {
        console.log('Value changed:', value);
    };

    // Handle array of specific types
    if (type.startsWith(`${this.inputTypes.ARRAY}_of_`)) {
        const itemType = type.split('_of_')[1];
        return this.createNestedArrayInput(
            defaultValue, 
            onChangeCallback, 
            depth, 
            itemType
        );
    }

    // Rest of the method remains the same...
}