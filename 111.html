# Directory Structure
iot_catalogue/
├── templates/
│   ├── base.html
│   └── iot_catalogue/
│       ├── index.html
│       ├── components/
│       │   ├── search_form.html
│       │   ├── results_table.html
│       │   └── user_assignment_modal.html
│       └── includes/
│           └── scripts.html
├── static/
│   └── iot_catalogue/
│       ├── css/
│       │   ├── main.css
│       │   ├── optimized-select.css
│       │   └── results-table.css
│       └── js/
│           ├── optimized-select.js
│           ├── results-table.js
│           └── user-assignment.js

# Templates

1. templates/iot_catalogue/index.html:
{% extends 'iot_catalogue/base.html' %}
{% load static %}

{% block content %}
    {% include 'iot_catalogue/components/search_form.html' %}
    {% include 'iot_catalogue/components/results_table.html' %}
    {% include 'iot_catalogue/components/user_assignment_modal.html' %}
{% endblock %}

{% block extra_scripts %}
    {% include 'iot_catalogue/includes/scripts.html' %}
{% endblock %}

2. templates/iot_catalogue/components/search_form.html:
<form id="iot-search-form" method="post" action="{% url 'iot_catalogue:search' %}" class="row g-3">
    {% csrf_token %}
    <div class="col-md-6" id="search-form-left-col">
        {% include 'iot_catalogue/components/search_form/device_type.html' %}
        {% include 'iot_catalogue/components/search_form/model_number.html' %}
        {% include 'iot_catalogue/components/search_form/chipset_manufacturer.html' %}
        {% include 'iot_catalogue/components/search_form/procured_date.html' %}
        {% include 'iot_catalogue/components/search_form/availability.html' %}
    </div>
    
    <div class="col-md-6" id="search-form-right-col">
        {% include 'iot_catalogue/components/search_form/manufacturer.html' %}
        {% include 'iot_catalogue/components/search_form/model_year.html' %}
        {% include 'iot_catalogue/components/search_form/device_status.html' %}
        {% include 'iot_catalogue/components/search_form/geo_location.html' %}
    </div>

    <div class="col-12 text-end">
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-search me-2"></i>Search
        </button>
        <button type="reset" class="btn btn-secondary">
            <i class="fas fa-undo me-2"></i>Reset
        </button>
    </div>
</form>

3. templates/iot_catalogue/components/results_table.html:
{% if devices %}
<div class="card-body" id="results-card">
    <div class="table-shadow" id="results-table-container">
        <div class="table-container" id="results-scrollable-container">
            <table class="table table-hover table-sticky mb-0" id="results-table">
                <thead>
                    <tr class="bg-light" id="results-header-row">
                        {% for col_name in column_names %}
                            <th class="fw-semibold" id="col-header-{{ col_name|lower|slugify }}">{{ col_name }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody id="results-table-body"></tbody>
            </table>
        </div>
    </div>
</div>

<script id="devices-data" type="application/json">
    {{ devices|safe }}
</script>
{% endif %}

4. templates/iot_catalogue/components/user_assignment_modal.html:
<div class="modal fade" id="userAssignmentModal" tabindex="-1" aria-labelledby="userAssignmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" id="userAssignmentDialog">
        <div class="modal-content" id="userAssignmentContent">
            <div class="modal-header">
                <h5 class="modal-title" id="userAssignmentModalLabel">Assign User</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="userSelect" class="form-label">Select User</label>
                    <select class="form-select optimized-select" id="userSelect">
                        <option value="">Choose...</option>
                        {% for username in usernames %}
                            <option value="{{ username }}">{{ username }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="userAssignmentModalSaveBtn">Save changes</button>
            </div>
        </div>
    </div>
</div>

# Static Files

1. static/iot_catalogue/css/optimized-select.css:
.optimized-select-wrapper {
    position: relative;
    width: 100%;
}

.optimized-select-button {
    width: 100%;
    text-align: left;
    cursor: pointer;
}

.optimized-select-dropdown {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 1000;
    margin-top: 0.25rem;
}

.optimized-select-search {
    width: 100%;
    padding: 0.5rem;
    border-bottom: 1px solid #dee2e6;
    border-radius: 0.375rem 0.375rem 0 0;
}

.optimized-select-options {
    overflow-y: auto;
    position: relative;
    border-radius: 0 0 0.375rem 0.375rem;
}

.virtual-scroll-container {
    position: relative;
}

.optimized-select-option {
    padding: 0.5rem 1rem;
    cursor: pointer;
    position: absolute;
    width: 100%;
    display: flex;
    align-items: center;
}

.optimized-select-option:hover {
    background-color: #f8f9fa;
}

2. static/iot_catalogue/css/results-table.css:
.table-container {
    position: relative;
    max-height: calc(100vh - 300px);
    overflow: auto;
}

.table-sticky thead {
    position: sticky;
    top: 0;
    z-index: 1;
    background-color: #f8f9fa;
}

.table-container::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

.table-container::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.table-container::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 4px;
}

.table-container::-webkit-scrollbar-thumb:hover {
    background: #555;
}

.table-sticky th,
.table-sticky td {
    white-space: nowrap;
    padding: 0.75rem;
}

.table-shadow {
    box-shadow: inset 0 0 5px rgba(0,0,0,0.15);
    border-radius: 0.375rem;
}

.current-user-cell {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.current-user-text {
    flex-grow: 1;
}

.current-user-edit-icon {
    color: #6c757d;
    cursor: pointer;
    transition: color 0.2s ease;
}

.current-user-edit-icon:hover {
    color: #0d6efd;
}

3. static/iot_catalogue/js/optimized-select.js:
class OptimizedSelect {
    constructor(originalSelect, options = {}) {
        this.originalSelect = originalSelect;
        this.options = options;
        this.itemHeight = 35;
        this.visibleItems = 8;
        this.allOptions = Array.from(originalSelect.options).map(opt => ({
            value: opt.value,
            label: opt.text
        }));
        this.isOpen = false;

        this.init();
    }

    // ... (rest of the OptimizedSelect class implementation)
}

4. static/iot_catalogue/js/results-table.js:
document.addEventListener('DOMContentLoaded', function() {
    const devicesData = JSON.parse(document.getElementById('devices-data')?.textContent || '[]');
    const tableBody = document.getElementById('results-table-body');
    
    if (!tableBody) return;

    devicesData.forEach((device, rowIndex) => {
        const row = createTableRow(device);
        tableBody.appendChild(row);
    });
});

function createTableRow(device) {
    // ... (implementation of table row creation)
}

5. static/iot_catalogue/js/user-assignment.js:
document.addEventListener('DOMContentLoaded', function() {
    initializeUserAssignment();
});

function initializeUserAssignment() {
    const modal = document.getElementById('userAssignmentModal');
    const saveBtn = document.getElementById('userAssignmentModalSaveBtn');
    
    if (!modal || !saveBtn) return;

    // ... (rest of the user assignment functionality)
}

function getCookie(name) {
    // ... (cookie retrieval implementation)
}