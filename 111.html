const parsedData = {};
            const formElements = this.elements;
            console.log(formElements)

            // Add the selected configuration type to parsedData
            const selectedConfig = document.getElementById('configDropdown').value;
            parsedData['config_name'] = selectedConfig;  // Add this line to include the selected configuration
    
            for (let element of formElements) {
                if (element.name && element.name !== 'csrfmiddlewaretoken') {
                    try {
                        // Attempt to parse the input value
                        const value = element.value.trim();
                        
                        if (value.startsWith('[') || value.startsWith('{')) {
                            // Parse JSON for arrays and objects
                            parsedData[element.name] = JSON.parse(value);
                        } else if (value === 'true' || value === 'false' || value === 'True' || value === 'False') {
                            // Parse boolean
                            parsedData[element.name] = (value === 'true' || value === 'True');
                        } else if (!isNaN(value) && value !== '') {
                            // Parse number
                            parsedData[element.name] = Number(value);
                        } else {
                            // Keep as string
                            parsedData[element.name] = value;
                        }
                    } catch (error) {
                        console.error(`Error parsing ${element.name}:`, error);
                        parsedData[element.name] = element.value;
                    }
                }
            }





function getDataTypeRules(datatype) {
        const rules = {
            'str': 'Enter text without quotes, or use "" for empty string',
            'list': 'Enter comma-separated values without quotes/brackets, or use "" for empty list',
            'dict': 'Enter a valid JSON object, use {} for empty object',
            'bool': 'Enter true or false',
            'int': 'Enter a whole number, or use "" for null',
            'float': 'Enter a decimal number, or use "" for null'
        };
        return `Rules: ${rules[datatype] || 'Enter a valid value'}`;
    }

    // Function to validate input based on datatype
    function validateInput(input) {
        const value = input.value.trim();
        const datatype = input.dataset.datatype;
        const validationMessage = document.getElementById(`${input.name}-validation`);

        // If validation message element doesn't exist, create it
        let messageElement = validationMessage;
        if (!messageElement) {
            messageElement = document.createElement('div');
            messageElement.className = 'invalid-feedback';
            messageElement.id = `${input.name}-validation`;
            input.parentNode.insertBefore(messageElement, input.nextSibling);
        }

        // Check for intentionally empty value with quotes
        if (value === '""') {
            input.classList.remove('is-invalid');
            input.classList.add('is-valid');
            validationMessage.style.display = 'none';
            return true;
        }

        // Check if field is empty (not intentionally empty)
        if (!value) {
            input.classList.add('is-invalid');
            input.classList.remove('is-valid');
            validationMessage.textContent = 'This field is required. Use "" for empty value.';
            validationMessage.style.display = 'block';
            return false;
        }

        try {
            switch (datatype) {
                case 'str':
                    if (value.includes('"') || value.includes("'")) {
                        throw new Error('Quotes are only allowed as "" to indicate empty value');
                    }
                    break;
                    
                case 'list':
                    if (value.includes('"') || value.includes("'") || value.includes('[') || value.includes(']')) {
                        throw new Error('Use comma-separated values without quotes/brackets, or "" for empty list');
                    }
                    break;
                    
                case 'dict':
                    if (value.includes('""')) {
                        throw new Error('Use {} for empty object, not ""');
                    }
                    JSON.parse(value);
                    break;
                    
                case 'bool':
                    if (!['true', 'false'].includes(value.toLowerCase())) {
                        throw new Error('Value must be true or false');
                    }
                    break;
                    
                case 'int':
                    if (!Number.isInteger(Number(value))) {
                        throw new Error('Value must be a whole number, or "" for null');
                    }
                    break;
                    
                case 'float':
                    if (isNaN(Number(value))) {
                        throw new Error('Value must be a number, or "" for null');
                    }
                    break;
            }
            
            input.classList.remove('is-invalid');
            input.classList.add('is-valid');
            validationMessage.style.display = 'none';
            return true;
        } catch (error) {
            input.classList.remove('is-valid');
            input.classList.add('is-invalid');
            validationMessage.textContent = error.message;
            validationMessage.style.display = 'block';
            return false;
        }
    }

    // Function to parse value based on datatype
    function parseValue(value, datatype) {
        const trimmedValue = value.trim();
    
        // Handle intentionally empty values marked with ""
        if (trimmedValue === '""') {
            switch (datatype) {
                case 'list':
                    return [];
                case 'dict':
                    return {};
                case 'int':
                case 'float':
                    return null;
                case 'str':
                    return '';
                default:
                    return '';
            }
        }

        // Parse non-empty values
        switch (datatype) {
            case 'list':
                return trimmedValue === '' ? [] : trimmedValue;
            case 'dict':
                return trimmedValue === '{}' ? {} : JSON.parse(trimmedValue);
            case 'bool':
                return trimmedValue.toLowerCase() === 'true';
            case 'int':
                return parseInt(trimmedValue);
            case 'float':
                return parseFloat(trimmedValue);
            default:
                return trimmedValue;
        }
    }


const formElements = this.elements;
            let isValid = true;
            let firstInvalidInput = null;
            console.log(formElements)

            const parsedData = {};
            // Add the selected configuration type to parsedData
            const selectedConfig = document.getElementById('configDropdown').value;
            parsedData['config_name'] = selectedConfig;  // Add this line to include the selected configuration

            // Validate all inputs
            for (let element of formElements) {
                if (element.name && element.name !== 'csrfmiddlewaretoken') {
                    console.log(element.name)
                    console.log(element.value)
                    if (!validateInput(element)) {
                        console.log(element.name)
                        isValid = false;
                        if (!firstInvalidInput) {
                            firstInvalidInput = element;
                        }
                    }
                }
            }

            if (!isValid) {
                firstInvalidInput.focus();
                return;
            }

            // Parse and add form data
            for (let element of formElements) {
                if (element.name && element.name !== 'csrfmiddlewaretoken') {
                    parsedData[element.name] = parseValue(
                        element.value.trim(),
                        element.dataset.datatype
                    );
                }
            }
            console.log(parsedData)
